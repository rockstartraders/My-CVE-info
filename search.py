#!/usr/bin/python3.6

import requests
import json
import sys
import os

a = 'http://cve.circl.lu/api/cve/'

while True:

    print()
    b = input('Enter CVE ID: ')
    if b == 'exit' or b == 'Exit':
        print()
        print()
        print(u'\u001b[36;1mThank You ..\u001b[0m')
        print()
        break
    elif b == 'clear':
        os.system('clear')
        continue  # reload the page
    x = a + b
    search = requests.get(x).json()

    print()
    print()
    print(u'\u001b[32;1mCVE Details:\u001b[0m')
    try:
        search_1 = search['id']
        print('ID: ' + search_1.replace('"', ''))


# dito ang reference
        search_2 = search['Modified']  # datetime
        xb = search_2.split('T')
        xb1 = xb.pop(0)  # if you want to strip the time
        print('Modified Date: ' + str(xb1))


        search_3 = search['Published']  # datetime
        aa = search_3.split('T')
        aa1 = aa.pop(0)  # if you want to strip the time
        print('Published Date: ' + str(aa1))


        search_4 = search['cvss-time']  # datetime
        print('CVSS Date and Time: ' + search_4.replace('T', ' Time:'))

        search_5 = search['cvss']
        search_5a = str(search_5)
        print('CVSS Base Score: ' + search_5a.replace('"', ''))

        search_6 = search['impact']['availability']
        print('Availability: ' + search_6.replace('"', ''))

        search_7 = search['impact']['confidentiality']
        print('Confidentiality: ' + search_7.replace('"', ''))

        search_8 = search['impact']['integrity']
        print('Integrity: ' + search_8.replace('"', ''))

        search_9 = search['access']['authentication']
        print('Authentication: ' + search_9.replace('"', ''))

        search_10 = search['access']['complexity']
        print('Complexity: ' + search_10.replace('"', ''))

        search_11 = search['access']['vector']
        print('Vector: ' + search_11.replace('"', ''))

        print()
        search_12 = search['references']
        search_12a = str(search_12)
        search_12b = str(search_12a.replace(",", ''))
        search_12c = str(search_12b.replace("[", ''))
        search_12d = str(search_12c.replace("]", ''))
        search_12e = str(search_12d.replace("'", ''))
        print(u'\u001b[32;1mReferences:\u001b[0m\n' + search_12e.replace(' ', '\n'))

        print()
        print(u'\u001b[32;1mSummary: \n' + '\u001b[0m')
        if True:
            search_14 = search['summary']
            search_14a = str(search_14)
            print(search_14a.strip('\n'))
        else:
            print('No Information Found for this category ..')

        print()
        print()
        print()
        print(u'\u001b[32;1mSolutions: \n' + '\u001b[0m')  # + json.dumps(search_14a).encode("utf-8"))
        if True:
            search_15 = search['capec'][0]['solutions']
            search_15a = str(search_15)
            print(search_15a.strip('\n'))
        else:
            sys.exit



        print()
        print()
        print()
        if True:
            search_16 = search['capec'][1]['solutions']
            search_16a = str(search_16)
            print(search_16a.strip('\n'))
        else:
            sys.exit


        print()
        print()
        print()
        if True:
            search_17 = search['capec'][2]['solutions']
            search_17a = str(search_17)
            print(search_17a.strip('\n'))
        else:
            sys.exit


        print()
        print()
        print()
        if True:
            search_18 = search['capec'][3]['solutions']
            search_18a = str(search_18)
            print(search_18a.strip('\n'))
        else:
            sys.exit

        print()
        print()
        print()
        if True:
            search_19 = search['capec'][4]['solutions']
            search_19a = str(search_19)
            print(search_19a.strip('\n'))
        else:
            sys.exit

        print()
        print()
        print()
        if True:
            search_20 = search['capec'][5]['solutions']
            search_20a = str(search_20)
            print(search_20a.strip('\n'))
        else:
            sys.exit

        print()
        print()
        print()
        if True:
            search_21 = search['capec'][6]['solutions']
            search_21a = str(search_21)
            print(search_21a.strip('\n'))
        else:
            sys.exit

        print()
        print()
        print()
        if True:
            search_22 = search['capec'][7]['solutions']
            search_22a = str(search_22)
            print(search_22a.strip('\n'))
        else:
            sys.exit


        print()
        print()
        print()
        if True:
            search_23 = search['capec'][8]['solutions']
            search_23a = str(search_23)
            print(search_23a.strip('\n'))
        else:
            sys.exit

        print()
        print()
        print()
        if True:
            search_24 = search['capec'][9]['solutions']
            search_24a = str(search_24)
            print(search_24a.strip('\n'))
        else:
            sys.exit

        print()
        print()
        print()
        if True:
            search_25 = search['capec'][9]['solutions']
            search_25a = str(search_25)
            print(search_25a.strip('\n'))
        else:
            sys.exit

        print()
        print()
        print(u'\u001b[36;1mEnd of Report ..\u001b[0m')
        print()
        print()




    except Exception as e:
        print(e)
