#!//usr/bin/python3.6

import requests
import json
import os

url = 'http://cve.circl.lu/api/search/'

while True:

    print()
    print(u'Please Type \u001b[32mexit\u001b[0m to close this program or\u001b[0m Type \u001b[32mclear\u001b[0m to clear the screen.')
    print()
    a = input('Enter Application Name (e.g \u001b[37;1mOutlook\u001b[0m, \u001b[37;1mSkype\u001b[0m, \u001b[37;1mTeamviewer\u001b[0m, \u001b[37;1metc\u001b[0m.): ')  # add u for it to work
    print()
    print()
    if a == 'exit' or a == 'Exit':
        print()
        print()
        print('Thank You ..')
        print()
        break
    elif a == 'clear':
        os.system('clear')
        continue  # reload the page

    x = url + a

    try:
        print(u"\u001b[31mNote\u001b[0m: Only the last 10 results or report can be displayed. If you know the CVE ID please feel free to search for it.")
        print()
        print("This query may take a while")
        print("Please wait ..")
        # para try
        cve_search = requests.get(x).json()


        # for time iso format
        print()
        search_id = cve_search['data'][0]['id']
        print(u'ID: \u001b[32m' + json.dumps(search_id))

        search_mod = cve_search['data'][0]['Modified']
        print(u'\u001b[0mModified Date: ' + search_mod.replace('T', ' Time:' ))

        search_pub = cve_search['data'][0]['Published']
        print('Published Date:' + search_pub.replace('T', ' Time:' ))

        search_auth = cve_search['data'][0]['access']['authentication']
        print('Authentication: ' + json.dumps(search_auth))

        search_comp = cve_search['data'][0]['access']['complexity']
        print('Complexity: ' + json.dumps(search_comp))

        search_vector = cve_search['data'][0]['access']['vector']
        print('Complexity: ' + json.dumps(search_vector))

        search_cvss = cve_search['data'][0]['cvss']
        print('cvss: ' + json.dumps(search_cvss))

        search_cvsstime= cve_search['data'][0]['cvss-time']
        print('cvss-time: ' + search_cvsstime.replace('T', ' Time:' ))

        search_availability = cve_search['data'][0]['impact']['availability']
        print('Availability: ' + json.dumps(search_availability))

        search_confident = cve_search['data'][0]['impact']['confidentiality']
        print('Confidentiality: ' + json.dumps(search_confident))

        search_integrity = cve_search['data'][0]['impact']['integrity']
        print('Integrity: ' + json.dumps(search_integrity ))

        search_ref = cve_search['data'][0]['references']
        print(u'\u001b[36mReferences:\u001b[0m ' + json.dumps(search_ref))

        print()
        search_sum = cve_search['data'][0]['summary']
        print(u'\u001b[31mSummary: \u001b[0m' + json.dumps(search_sum))
        print()

        search_vulnc = cve_search['data'][0]['vulnerable_configuration']
        print(u'\u001b[36mVulnerable Configuration:\u001b[0m ' + json.dumps(search_vulnc))
        print()

        search_vulnc2 = cve_search['data'][0]['vulnerable_configuration_cpe_2_2']
        print(u'\u001b[36mVulnerable Cconfiguration Cpe_2_2:\u001b[0m ' + json.dumps(search_vulnc2))
        print()
        print()

        # message instruction
        # new line / Break

        print()
        search_id = cve_search['data'][1]['id']
        print(u'ID: \u001b[32m' + json.dumps(search_id))

        search_mod = cve_search['data'][1]['Modified']
        print(u'\u001b[0mModified Date: ' + search_mod.replace('T', ' Time:'))

        search_pub = cve_search['data'][1]['Published']
        print('Published Date:' + search_pub.replace('T', ' Time:'))

        search_auth = cve_search['data'][1]['access']['authentication']
        print('Authentication: ' + json.dumps(search_auth))

        search_comp = cve_search['data'][1]['access']['complexity']
        print('Complexity: ' + json.dumps(search_comp))

        search_vector = cve_search['data'][1]['access']['vector']
        print('Complexity: ' + json.dumps(search_vector))

        search_cvss = cve_search['data'][1]['cvss']
        print('cvss: ' + json.dumps(search_cvss))

        search_cvsstime = cve_search['data'][1]['cvss-time']
        print('cvss-time: ' + search_cvsstime.replace('T', ' Time:'))

        search_availability = cve_search['data'][1]['impact']['availability']
        print('Availability: ' + json.dumps(search_availability))

        search_confident = cve_search['data'][1]['impact']['confidentiality']
        print('Confidentiality: ' + json.dumps(search_confident))

        search_integrity = cve_search['data'][1]['impact']['integrity']
        print('Integrity: ' + json.dumps(search_integrity))

        search_ref = cve_search['data'][1]['references']
        print(u'\u001b[36mReferences:\u001b[0m ' + json.dumps(search_ref))

        print()
        search_sum = cve_search['data'][1]['summary']
        print(u'\u001b[31mSummary: \u001b[0m' + json.dumps(search_sum))
        print()

        search_vulnc = cve_search['data'][1]['vulnerable_configuration']
        print(u'\u001b[36mVulnerable Configuration:\u001b[0m ' + json.dumps(search_vulnc))
        print()

        search_vulnc2 = cve_search['data'][1]['vulnerable_configuration_cpe_2_2']
        print(u'\u001b[36mVulnerable Cconfiguration Cpe_2_2:\u001b[0m ' + json.dumps(search_vulnc2))
        print()
        print()

        # new line / Break

        print()
        search_id = cve_search['data'][2]['id']
        print(u'ID: \u001b[32m' + json.dumps(search_id))

        search_mod = cve_search['data'][2]['Modified']
        print(u'\u001b[0mModified Date: ' + search_mod.replace('T', ' Time:'))

        search_pub = cve_search['data'][2]['Published']
        print('Published Date:' + search_pub.replace('T', ' Time:'))

        search_auth = cve_search['data'][2]['access']['authentication']
        print('Authentication: ' + json.dumps(search_auth))

        search_comp = cve_search['data'][2]['access']['complexity']
        print('Complexity: ' + json.dumps(search_comp))

        search_vector = cve_search['data'][2]['access']['vector']
        print('Complexity: ' + json.dumps(search_vector))

        search_cvss = cve_search['data'][2]['cvss']
        print('cvss: ' + json.dumps(search_cvss))

        search_cvsstime = cve_search['data'][2]['cvss-time']
        print('cvss-time: ' + search_cvsstime.replace('T', ' Time:'))

        search_availability = cve_search['data'][2]['impact']['availability']
        print('Availability: ' + json.dumps(search_availability))

        search_confident = cve_search['data'][2]['impact']['confidentiality']
        print('Confidentiality: ' + json.dumps(search_confident))

        search_integrity = cve_search['data'][2]['impact']['integrity']
        print('Integrity: ' + json.dumps(search_integrity))

        search_ref = cve_search['data'][2]['references']
        print(u'\u001b[36mReferences:\u001b[0m ' + json.dumps(search_ref))

        print()
        search_sum = cve_search['data'][2]['summary']
        print(u'\u001b[31mSummary: \u001b[0m' + json.dumps(search_sum))
        print()

        search_vulnc = cve_search['data'][2]['vulnerable_configuration']
        print(u'\u001b[36mVulnerable Configuration:\u001b[0m ' + json.dumps(search_vulnc))
        print()

        search_vulnc2 = cve_search['data'][2]['vulnerable_configuration_cpe_2_2']
        print(u'\u001b[36mVulnerable Cconfiguration Cpe_2_2:\u001b[0m ' + json.dumps(search_vulnc2))
        print()
        print()

        # new line / Break

        print()
        search_id = cve_search['data'][3]['id']
        print(u'ID: \u001b[32m' + json.dumps(search_id))

        search_mod = cve_search['data'][3]['Modified']
        print(u'\u001b[0mModified Date: ' + search_mod.replace('T', ' Time:'))

        search_pub = cve_search['data'][3]['Published']
        print('Published Date:' + search_pub.replace('T', ' Time:'))

        search_auth = cve_search['data'][3]['access']['authentication']
        print('Authentication: ' + json.dumps(search_auth))

        search_comp = cve_search['data'][3]['access']['complexity']
        print('Complexity: ' + json.dumps(search_comp))

        search_vector = cve_search['data'][3]['access']['vector']
        print('Complexity: ' + json.dumps(search_vector))

        search_cvss = cve_search['data'][3]['cvss']
        print('cvss: ' + json.dumps(search_cvss))

        search_cvsstime = cve_search['data'][3]['cvss-time']
        print('cvss-time: ' + search_cvsstime.replace('T', ' Time:'))

        search_availability = cve_search['data'][3]['impact']['availability']
        print('Availability: ' + json.dumps(search_availability))

        search_confident = cve_search['data'][3]['impact']['confidentiality']
        print('Confidentiality: ' + json.dumps(search_confident))

        search_integrity = cve_search['data'][3]['impact']['integrity']
        print('Integrity: ' + json.dumps(search_integrity))

        search_ref = cve_search['data'][3]['references']
        print(u'\u001b[36mReferences:\u001b[0m ' + json.dumps(search_ref))

        print()
        search_sum = cve_search['data'][3]['summary']
        print(u'\u001b[31mSummary: \u001b[0m' + json.dumps(search_sum))
        print()

        search_vulnc = cve_search['data'][3]['vulnerable_configuration']
        print(u'\u001b[36mVulnerable Configuration:\u001b[0m ' + json.dumps(search_vulnc))
        print()

        search_vulnc2 = cve_search['data'][3]['vulnerable_configuration_cpe_2_2']
        print(u'\u001b[36mVulnerable Cconfiguration Cpe_2_2:\u001b[0m ' + json.dumps(search_vulnc2))
        print()
        print()

        # new line / Break

        print()
        search_id = cve_search['data'][4]['id']
        print(u'ID: \u001b[32m' + json.dumps(search_id))

        search_mod = cve_search['data'][4]['Modified']
        print(u'\u001b[0mModified Date: ' + search_mod.replace('T', ' Time:'))

        search_pub = cve_search['data'][4]['Published']
        print('Published Date:' + search_pub.replace('T', ' Time:'))

        search_auth = cve_search['data'][4]['access']['authentication']
        print('Authentication: ' + json.dumps(search_auth))

        search_comp = cve_search['data'][4]['access']['complexity']
        print('Complexity: ' + json.dumps(search_comp))

        search_vector = cve_search['data'][4]['access']['vector']
        print('Complexity: ' + json.dumps(search_vector))

        search_cvss = cve_search['data'][4]['cvss']
        print('cvss: ' + json.dumps(search_cvss))

        search_cvsstime = cve_search['data'][4]['cvss-time']
        print('cvss-time: ' + search_cvsstime.replace('T', ' Time:'))

        search_availability = cve_search['data'][4]['impact']['availability']
        print('Availability: ' + json.dumps(search_availability))

        search_confident = cve_search['data'][4]['impact']['confidentiality']
        print('Confidentiality: ' + json.dumps(search_confident))

        search_integrity = cve_search['data'][4]['impact']['integrity']
        print('Integrity: ' + json.dumps(search_integrity))

        search_ref = cve_search['data'][4]['references']
        print(u'\u001b[36mReferences:\u001b[0m ' + json.dumps(search_ref))

        print()
        search_sum = cve_search['data'][4]['summary']
        print(u'\u001b[31mSummary: \u001b[0m' + json.dumps(search_sum))
        print()

        search_vulnc = cve_search['data'][4]['vulnerable_configuration']
        print(u'\u001b[36mVulnerable Configuration:\u001b[0m ' + json.dumps(search_vulnc))
        print()

        search_vulnc2 = cve_search['data'][4]['vulnerable_configuration_cpe_2_2']
        print(u'\u001b[36mVulnerable Cconfiguration Cpe_2_2:\u001b[0m ' + json.dumps(search_vulnc2))
        print()
        print()

        # new line / Break

        print()
        search_id = cve_search['data'][5]['id']
        print(u'ID: \u001b[32m' + json.dumps(search_id))

        search_mod = cve_search['data'][5]['Modified']
        print(u'\u001b[0mModified Date: ' + search_mod.replace('T', ' Time:'))

        search_pub = cve_search['data'][5]['Published']
        print('Published Date:' + search_pub.replace('T', ' Time:'))

        search_auth = cve_search['data'][5]['access']['authentication']
        print('Authentication: ' + json.dumps(search_auth))

        search_comp = cve_search['data'][5]['access']['complexity']
        print('Complexity: ' + json.dumps(search_comp))

        search_vector = cve_search['data'][5]['access']['vector']
        print('Complexity: ' + json.dumps(search_vector))

        search_cvss = cve_search['data'][5]['cvss']
        print('cvss: ' + json.dumps(search_cvss))

        search_cvsstime = cve_search['data'][5]['cvss-time']
        print('cvss-time: ' + search_cvsstime.replace('T', ' Time:'))

        search_availability = cve_search['data'][5]['impact']['availability']
        print('Availability: ' + json.dumps(search_availability))

        search_confident = cve_search['data'][5]['impact']['confidentiality']
        print('Confidentiality: ' + json.dumps(search_confident))

        search_integrity = cve_search['data'][5]['impact']['integrity']
        print('Integrity: ' + json.dumps(search_integrity))

        search_ref = cve_search['data'][5]['references']
        print(u'\u001b[36mReferences:\u001b[0m ' + json.dumps(search_ref))

        print()
        search_sum = cve_search['data'][5]['summary']
        print(u'\u001b[31mSummary: \u001b[0m' + json.dumps(search_sum))
        print()

        search_vulnc = cve_search['data'][5]['vulnerable_configuration']
        print(u'\u001b[36mVulnerable Configuration:\u001b[0m ' + json.dumps(search_vulnc))
        print()

        search_vulnc2 = cve_search['data'][5]['vulnerable_configuration_cpe_2_2']
        print(u'\u001b[36mVulnerable Cconfiguration Cpe_2_2:\u001b[0m ' + json.dumps(search_vulnc2))
        print()
        print()

        # new line / Break

        print()
        search_id = cve_search['data'][6]['id']
        print(u'ID: \u001b[32m' + json.dumps(search_id))

        search_mod = cve_search['data'][6]['Modified']
        print(u'\u001b[0mModified Date: ' + search_mod.replace('T', ' Time:'))

        search_pub = cve_search['data'][6]['Published']
        print('Published Date:' + search_pub.replace('T', ' Time:'))

        search_auth = cve_search['data'][6]['access']['authentication']
        print('Authentication: ' + json.dumps(search_auth))

        search_comp = cve_search['data'][6]['access']['complexity']
        print('Complexity: ' + json.dumps(search_comp))

        search_vector = cve_search['data'][6]['access']['vector']
        print('Complexity: ' + json.dumps(search_vector))

        search_cvss = cve_search['data'][6]['cvss']
        print('cvss: ' + json.dumps(search_cvss))

        search_cvsstime = cve_search['data'][6]['cvss-time']
        print('cvss-time: ' + search_cvsstime.replace('T', ' Time:'))

        search_availability = cve_search['data'][6]['impact']['availability']
        print('Availability: ' + json.dumps(search_availability))

        search_confident = cve_search['data'][6]['impact']['confidentiality']
        print('Confidentiality: ' + json.dumps(search_confident))

        search_integrity = cve_search['data'][6]['impact']['integrity']
        print('Integrity: ' + json.dumps(search_integrity))

        search_ref = cve_search['data'][6]['references']
        print(u'\u001b[36mReferences:\u001b[0m ' + json.dumps(search_ref))

        print()
        search_sum = cve_search['data'][6]['summary']
        print(u'\u001b[31mSummary: \u001b[0m' + json.dumps(search_sum))
        print()

        search_vulnc = cve_search['data'][6]['vulnerable_configuration']
        print(u'\u001b[36mVulnerable Configuration:\u001b[0m ' + json.dumps(search_vulnc))
        print()

        search_vulnc2 = cve_search['data'][6]['vulnerable_configuration_cpe_2_2']
        print(u'\u001b[36mVulnerable Cconfiguration Cpe_2_2:\u001b[0m ' + json.dumps(search_vulnc2))
        print()
        print()

        # new line / Break

        print()
        search_id = cve_search['data'][7]['id']
        print(u'ID: \u001b[32m' + json.dumps(search_id))

        search_mod = cve_search['data'][7]['Modified']
        print(u'\u001b[0mModified Date: ' + search_mod.replace('T', ' Time:'))

        search_pub = cve_search['data'][7]['Published']
        print('Published Date:' + search_pub.replace('T', ' Time:'))

        search_auth = cve_search['data'][7]['access']['authentication']
        print('Authentication: ' + json.dumps(search_auth))

        search_comp = cve_search['data'][7]['access']['complexity']
        print('Complexity: ' + json.dumps(search_comp))

        search_vector = cve_search['data'][7]['access']['vector']
        print('Complexity: ' + json.dumps(search_vector))

        search_cvss = cve_search['data'][7]['cvss']
        print('cvss: ' + json.dumps(search_cvss))

        search_cvsstime = cve_search['data'][7]['cvss-time']
        print('cvss-time: ' + search_cvsstime.replace('T', ' Time:'))

        search_availability = cve_search['data'][7]['impact']['availability']
        print('Availability: ' + json.dumps(search_availability))

        search_confident = cve_search['data'][7]['impact']['confidentiality']
        print('Confidentiality: ' + json.dumps(search_confident))

        search_integrity = cve_search['data'][7]['impact']['integrity']
        print('Integrity: ' + json.dumps(search_integrity))

        search_ref = cve_search['data'][7]['references']
        print(u'\u001b[36mReferences:\u001b[0m ' + json.dumps(search_ref))

        print()
        search_sum = cve_search['data'][7]['summary']
        print(u'\u001b[31mSummary: \u001b[0m' + json.dumps(search_sum))
        print()

        search_vulnc = cve_search['data'][7]['vulnerable_configuration']
        print(u'\u001b[36mVulnerable Configuration:\u001b[0m ' + json.dumps(search_vulnc))
        print()

        search_vulnc2 = cve_search['data'][7]['vulnerable_configuration_cpe_2_2']
        print(u'\u001b[36mVulnerable Cconfiguration Cpe_2_2:\u001b[0m ' + json.dumps(search_vulnc2))
        print()
        print()

        # new line / Break

        print()
        search_id = cve_search['data'][8]['id']
        print(u'ID: \u001b[32m' + json.dumps(search_id))

        search_mod = cve_search['data'][8]['Modified']
        print(u'\u001b[0mModified Date: ' + search_mod.replace('T', ' Time:'))

        search_pub = cve_search['data'][8]['Published']
        print('Published Date:' + search_pub.replace('T', ' Time:'))

        search_auth = cve_search['data'][8]['access']['authentication']
        print('Authentication: ' + json.dumps(search_auth))

        search_comp = cve_search['data'][8]['access']['complexity']
        print('Complexity: ' + json.dumps(search_comp))

        search_vector = cve_search['data'][8]['access']['vector']
        print('Complexity: ' + json.dumps(search_vector))

        search_cvss = cve_search['data'][8]['cvss']
        print('cvss: ' + json.dumps(search_cvss))

        search_cvsstime = cve_search['data'][8]['cvss-time']
        print('cvss-time: ' + search_cvsstime.replace('T', ' Time:'))

        search_availability = cve_search['data'][8]['impact']['availability']
        print('Availability: ' + json.dumps(search_availability))

        search_confident = cve_search['data'][8]['impact']['confidentiality']
        print('Confidentiality: ' + json.dumps(search_confident))

        search_integrity = cve_search['data'][8]['impact']['integrity']
        print('Integrity: ' + json.dumps(search_integrity))

        search_ref = cve_search['data'][8]['references']
        print(u'\u001b[36mReferences:\u001b[0m ' + json.dumps(search_ref))

        print()
        search_sum = cve_search['data'][8]['summary']
        print(u'\u001b[31mSummary: \u001b[0m' + json.dumps(search_sum))
        print()

        search_vulnc = cve_search['data'][8]['vulnerable_configuration']
        print(u'\u001b[36mVulnerable Configuration:\u001b[0m ' + json.dumps(search_vulnc))
        print()

        search_vulnc2 = cve_search['data'][8]['vulnerable_configuration_cpe_2_2']
        print(u'\u001b[36mVulnerable Cconfiguration Cpe_2_2:\u001b[0m ' + json.dumps(search_vulnc2))
        print()
        print()

        # new line / Break

        print()
        search_id = cve_search['data'][9]['id']
        print(u'ID: \u001b[32m' + json.dumps(search_id))

        search_mod = cve_search['data'][9]['Modified']
        print(u'\u001b[0mModified Date: ' + search_mod.replace('T', ' Time:'))

        search_pub = cve_search['data'][9]['Published']
        print('Published Date:' + search_pub.replace('T', ' Time:'))

        search_auth = cve_search['data'][9]['access']['authentication']
        print('Authentication: ' + json.dumps(search_auth))

        search_comp = cve_search['data'][9]['access']['complexity']
        print('Complexity: ' + json.dumps(search_comp))

        search_vector = cve_search['data'][9]['access']['vector']
        print('Complexity: ' + json.dumps(search_vector))

        search_cvss = cve_search['data'][9]['cvss']
        print('cvss: ' + json.dumps(search_cvss))

        search_cvsstime = cve_search['data'][9]['cvss-time']
        print('cvss-time: ' + search_cvsstime.replace('T', ' Time:'))

        search_availability = cve_search['data'][9]['impact']['availability']
        print('Availability: ' + json.dumps(search_availability))

        search_confident = cve_search['data'][9]['impact']['confidentiality']
        print('Confidentiality: ' + json.dumps(search_confident))

        search_integrity = cve_search['data'][9]['impact']['integrity']
        print('Integrity: ' + json.dumps(search_integrity))

        search_ref = cve_search['data'][9]['references']
        print(u'\u001b[36mReferences:\u001b[0m ' + json.dumps(search_ref))

        print()
        search_sum = cve_search['data'][9]['summary']
        print(u'\u001b[31mSummary: \u001b[0m' + json.dumps(search_sum))
        print()

        search_vulnc = cve_search['data'][9]['vulnerable_configuration']
        print(u'\u001b[36mVulnerable Configuration:\u001b[0m ' + json.dumps(search_vulnc))
        print()

        search_vulnc2 = cve_search['data'][9]['vulnerable_configuration_cpe_2_2']
        print(u'\u001b[36mVulnerable Cconfiguration Cpe_2_2:\u001b[0m ' + json.dumps(search_vulnc2))
        print()
        print()

        # new line / Break

        print()
        search_id = cve_search['data'][10]['id']
        print(u'ID: \u001b[32m' + json.dumps(search_id))

        search_mod = cve_search['data'][10]['Modified']
        print(u'\u001b[0mModified Date: ' + search_mod.replace('T', ' Time:'))

        search_pub = cve_search['data'][10]['Published']
        print('Published Date:' + search_pub.replace('T', ' Time:'))

        search_auth = cve_search['data'][10]['access']['authentication']
        print('Authentication: ' + json.dumps(search_auth))

        search_comp = cve_search['data'][10]['access']['complexity']
        print('Complexity: ' + json.dumps(search_comp))

        search_vector = cve_search['data'][10]['access']['vector']
        print('Complexity: ' + json.dumps(search_vector))

        search_cvss = cve_search['data'][10]['cvss']
        print('cvss: ' + json.dumps(search_cvss))

        search_cvsstime = cve_search['data'][10]['cvss-time']
        print('cvss-time: ' + search_cvsstime.replace('T', ' Time:'))

        search_availability = cve_search['data'][10]['impact']['availability']
        print('Availability: ' + json.dumps(search_availability))

        search_confident = cve_search['data'][10]['impact']['confidentiality']
        print('Confidentiality: ' + json.dumps(search_confident))

        search_integrity = cve_search['data'][10]['impact']['integrity']
        print('Integrity: ' + json.dumps(search_integrity))

        search_ref = cve_search['data'][10]['references']
        print(u'\u001b[36mReferences:\u001b[0m ' + json.dumps(search_ref))

        print()
        search_sum = cve_search['data'][10]['summary']
        print(u'\u001b[31mSummary: \u001b[0m' + json.dumps(search_sum))
        print()

        search_vulnc = cve_search['data'][10]['vulnerable_configuration']
        print(u'\u001b[36mVulnerable Configuration:\u001b[0m ' + json.dumps(search_vulnc))
        print()

        search_vulnc2 = cve_search['data'][10]['vulnerable_configuration_cpe_2_2']
        print(u'\u001b[36mVulnerable Cconfiguration Cpe_2_2:\u001b[0m ' + json.dumps(search_vulnc2))
        print()
        print()































    except Exception as e:
        print('')
        print('')
        print('{0}{1}'.format(u' Error Occurred !!\u001b[31m \n Either not found or Error With Connectivity. \n ',e))  # string format with catch
        print(u'\u001b[37m Please try again ..\u001b[37m\n')
        print()




























